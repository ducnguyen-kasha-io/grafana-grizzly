apiVersion: grizzly.grafana.com/v1alpha1
kind: Dashboard
metadata:
    folder: fen97rev6xp8ga
    name: fekl9lvt8iwaob
spec:
    annotations:
        list:
            - $$hashKey: object:247
              builtIn: 1
              datasource:
                type: datasource
                uid: grafana
              enable: true
              hide: true
              iconColor: rgba(0, 211, 255, 1)
              name: Annotations & Alerts
              target:
                limit: 100
                matchAny: false
                tags: []
                type: dashboard
              type: dashboard
    description: "Kubernetes Comprehensive display of resources:\n- Overall Resource Overview\n- Microservices Resource Details\n- Pod Resource Details \n- Network Bandwidth \n- Optimization metrics"
    editable: true
    fiscalYearStartMonth: 0
    graphTooltip: 0
    links: []
    panels:
        - collapsed: false
          gridPos:
            h: 1
            w: 24
            x: 0
            "y": 0
          id: 54
          panels: []
          title: Node Resource Overview：Selected Nodes:【$Node】
          type: row
        - datasource:
            type: prometheus
            uid: ${datasource}
          fieldConfig:
            defaults:
                color:
                    mode: palette-classic
                mappings: []
                thresholds:
                    mode: absolute
                    steps:
                        - color: green
                        - color: red
                          value: 80
            overrides: []
          gridPos:
            h: 2
            w: 24
            x: 0
            "y": 1
          id: 88
          maxPerRow: 2
          options:
            colorMode: background
            graphMode: none
            justifyMode: center
            orientation: auto
            percentChangeColorMode: standard
            reduceOptions:
                calcs:
                    - last
                fields: ""
                values: false
            showPercentChange: false
            text: {}
            textMode: auto
            wideLayout: true
          pluginVersion: 11.6.0
          repeat: origin_prometheus
          repeatDirection: v
          targets:
            - datasource:
                type: prometheus
                uid: ${datasource}
              editorMode: code
              exemplar: false
              expr: count(kube_pod_info)
              hide: false
              instant: true
              legendFormat: Total Pod
              range: false
              refId: A
            - datasource:
                type: prometheus
                uid: ${datasource}
              editorMode: code
              exemplar: false
              expr: count({__name__=~"kube_deployment_metadata_generation|kube_daemonset_metadata_generation|kube_statefulset_metadata_generation"})
              hide: false
              instant: true
              legendFormat: Workload
              range: false
              refId: B
            - datasource:
                type: prometheus
                uid: ${datasource}
              editorMode: code
              exemplar: false
              expr: count by()(kube_node_info)
              hide: false
              instant: true
              legendFormat: Total Nodes
              range: false
              refId: C
          title: ""
          type: stat
        - datasource:
            type: prometheus
            uid: ${datasource}
          fieldConfig:
            defaults:
                color:
                    mode: thresholds
                custom:
                    align: center
                    cellOptions:
                        type: auto
                    filterable: false
                    inspect: false
                mappings: []
                max: 1
                min: 0
                thresholds:
                    mode: absolute
                    steps:
                        - color: green
            overrides:
                - matcher:
                    id: byRegexp
                    options: .*%
                  properties:
                    - id: custom.cellOptions
                      value:
                        mode: gradient
                        type: color-background
                    - id: color
                      value:
                        mode: continuous-GrYlRd
                    - id: custom.width
                      value: 85
                    - id: unit
                      value: percentunit
                    - id: decimals
                      value: 0
                - matcher:
                    id: byRegexp
                    options: (Memory Usage|Total Memory|Memory Request|Memory Limit|Disk Usage|Disk Total)
                  properties:
                    - id: unit
                      value: bytes
                - matcher:
                    id: byRegexp
                    options: /.*Total/
                  properties:
                    - id: custom.cellOptions
                      value:
                        mode: gradient
                        type: color-background
                    - id: custom.cellOptions
                      value:
                        mode: gradient
                        type: color-background
                    - id: color
                      value:
                        fixedColor: blue
                        mode: fixed
                    - id: decimals
                      value: 0
                - matcher:
                    id: byName
                    options: Total Cores
                  properties:
                    - id: custom.width
                      value: 100
                - matcher:
                    id: byName
                    options: Host Name
                  properties:
                    - id: custom.width
                      value: 403
          gridPos:
            h: 11
            w: 14
            x: 0
            "y": 3
          id: 52
          options:
            cellHeight: sm
            footer:
                countRows: false
                enablePagination: false
                fields: ""
                reducer:
                    - sum
                show: false
            showHeader: true
            sortBy:
                - desc: true
                  displayName: Memory Usage%
          pluginVersion: 11.6.0
          targets:
            - datasource:
                type: prometheus
                uid: ${datasource}
              editorMode: code
              exemplar: false
              expr: sum (irate(container_cpu_usage_seconds_total{container!="",node=~"^$Node$"}[2m]))by (node) / sum(kube_node_status_allocatable{resource="cpu", unit="core", node=~"^$Node$"})by (node)
              format: table
              hide: false
              instant: true
              interval: ""
              legendFormat: CPU Usage%
              refId: A
            - datasource:
                type: prometheus
                uid: ${datasource}
              editorMode: code
              exemplar: false
              expr: sum (container_memory_working_set_bytes{container!=""})by (node) / sum(kube_node_status_allocatable{resource="memory", unit="byte"})by (node)
              format: table
              hide: false
              instant: true
              interval: ""
              legendFormat: Memory Usage%
              refId: B
            - datasource:
                type: prometheus
                uid: ${datasource}
              editorMode: code
              exemplar: false
              expr: kube_node_status_allocatable{origin_prometheus=~"$origin_prometheus",resource="cpu", unit="core", node=~"^$Node$"} - 0
              format: table
              hide: false
              instant: true
              interval: ""
              legendFormat: ""
              refId: C
            - datasource:
                type: prometheus
                uid: ${datasource}
              editorMode: code
              exemplar: false
              expr: sum(kube_node_status_allocatable{origin_prometheus=~"$origin_prometheus",resource="memory", unit="byte", node=~"^$Node$"}) by (node) - 0
              format: table
              hide: false
              instant: true
              interval: ""
              legendFormat: ""
              refId: D
          title: All Node Information Detail
          transformations:
            - id: merge
              options: {}
            - id: organize
              options:
                excludeByName:
                    __name__: true
                    Time: true
                    Time 1: true
                    Time 2: true
                    Time 3: true
                    Time 4: true
                    Time 5: true
                    Time 6: true
                    Time 7: true
                    Time 8: true
                    Time 9: true
                    Time 10: true
                    Time 11: true
                    Time 12: true
                    Time 13: true
                    Time 14: true
                    Time 15: true
                    Time 16: true
                    Time 17: true
                    Time 18: true
                    Time 19: true
                    Time 20: true
                    'Value #A': false
                    'Value #B': false
                    'Value #C': false
                    'Value #D': false
                    'Value #E': true
                    'Value #F': true
                    'Value #G': true
                    'Value #H': true
                    'Value #I': true
                    'Value #J': true
                    'Value #K': true
                    'Value #L': true
                    'Value #N': true
                    'Value #O': true
                    'Value #Q': true
                    'Value #R': true
                    'Value #S': true
                    'Value #T': true
                    app_kubernetes_io_name: true
                    app_kubernetes_io_name 1: true
                    app_kubernetes_io_name 2: true
                    app_kubernetes_io_name 3: true
                    app_kubernetes_io_version: true
                    app_kubernetes_io_version 1: true
                    app_kubernetes_io_version 2: true
                    app_kubernetes_io_version 3: true
                    cluster: true
                    condition: true
                    instance: true
                    instance 1: true
                    instance 2: true
                    instance 3: true
                    job: true
                    job 1: true
                    job 2: true
                    job 3: true
                    k8s_cluster_name: true
                    k8s_namespace: true
                    k8s_namespace 1: true
                    k8s_namespace 2: true
                    k8s_namespace 3: true
                    k8s_sname: true
                    k8s_sname 1: true
                    k8s_sname 2: true
                    k8s_sname 3: true
                    node: false
                    origin_prometheus: true
                    origin_prometheus 1: true
                    origin_prometheus 2: true
                    origin_prometheus 3: true
                    resource: true
                    source: true
                    status: true
                    unit: true
                includeByName: {}
                indexByName:
                    Time: 7
                    'Value #A': 1
                    'Value #B': 2
                    'Value #C': 3
                    'Value #D': 4
                    cluster: 10
                    instance: 8
                    job: 9
                    k8s_cluster_name: 11
                    node: 0
                    resource: 5
                    source: 12
                    unit: 6
                renameByName:
                    'Value #A': CPU Usage%
                    'Value #B': Memory Usage%
                    'Value #C': Total Cores
                    'Value #D': Total Memory
                    'Value #E': CPU Requests
                    'Value #F': CPU Limit
                    'Value #G': Memory Requests
                    'Value #H': Memory Limit
                    'Value #I': CPU Core Usage
                    'Value #J': Memory Usage
                    'Value #K': Disk Usage
                    'Value #L': Disk Total
                    'Value #M': Memory Usage%
                    'Value #N': Memory Requests%
                    'Value #O': Memory Limit%
                    'Value #P': CPU Usage%
                    'Value #Q': CPU Requests%
                    'Value #R': CPU Limit%
                    'Value #S': Disk Usage%
                    'Value #T': Pod Limit
                    condition: Status
                    node: Host Name
          type: table
        - datasource:
            type: prometheus
            uid: ${datasource}
          fieldConfig:
            defaults:
                color:
                    mode: palette-classic
                custom:
                    align: left
                    cellOptions:
                        type: color-background
                    filterable: false
                    inspect: false
                decimals: 0
                links: []
                mappings:
                    - options:
                        "0":
                            color: red
                            index: 0
                      type: value
                    - options:
                        match: "null"
                        result:
                            color: red
                            index: 1
                      type: special
                noValue: "0"
                thresholds:
                    mode: absolute
                    steps:
                        - color: green
                unit: bytes
            overrides:
                - matcher:
                    id: byName
                    options: PVC
                  properties:
                    - id: custom.width
                      value: 222
                - matcher:
                    id: byName
                    options: Usage
                  properties:
                    - id: custom.width
                      value: 87
                - matcher:
                    id: byName
                    options: Total
                  properties:
                    - id: custom.width
                      value: 89
                - matcher:
                    id: byName
                    options: Namespaces
                  properties:
                    - id: custom.width
                      value: 147
          gridPos:
            h: 11
            w: 10
            x: 14
            "y": 3
          id: 92
          options:
            cellHeight: sm
            footer:
                countRows: false
                fields: ""
                reducer:
                    - sum
                show: false
            showHeader: true
            sortBy:
                - desc: false
                  displayName: PVC
          pluginVersion: 11.6.0
          targets:
            - datasource:
                type: prometheus
                uid: ${datasource}
              editorMode: code
              exemplar: false
              expr: max by (namespace,persistentvolumeclaim) (kubelet_volume_stats_used_bytes)
              format: table
              instant: true
              interval: ""
              intervalFactor: 1
              legendFormat: '{{namespace}}:{{ persistentvolumeclaim }}'
              metric: container_memory_usage:sort_desc
              range: false
              refId: A
              step: 10
            - datasource:
                type: prometheus
                uid: ${datasource}
              editorMode: code
              exemplar: false
              expr: min by (namespace,persistentvolumeclaim) (kubelet_volume_stats_available_bytes) + max by (namespace,persistentvolumeclaim) (kubelet_volume_stats_used_bytes)
              format: table
              hide: false
              instant: true
              interval: ""
              intervalFactor: 1
              legendFormat: __auto
              metric: container_memory_usage:sort_desc
              range: false
              refId: B
              step: 10
          title: PVC Storage Usage
          transformations:
            - id: merge
              options: {}
            - id: organize
              options:
                excludeByName:
                    Time: true
                includeByName: {}
                indexByName: {}
                renameByName:
                    'Value #A': Usage
                    'Value #B': Total
                    'Value #C': Usage Rate
                    'Value #D': Mount Pod Number
                    namespace: Namespaces
                    persistentvolumeclaim: PVC
          type: table
        - datasource:
            type: prometheus
            uid: ${datasource}
          fieldConfig:
            defaults:
                color:
                    mode: palette-classic
                custom:
                    align: center
                    cellOptions:
                        type: color-text
                    filterable: false
                    inspect: false
                mappings: []
                noValue: "0"
                thresholds:
                    mode: absolute
                    steps:
                        - color: green
                        - color: red
                          value: 80
                unit: none
            overrides:
                - matcher:
                    id: byName
                    options: Spaces
                  properties:
                    - id: custom.width
                      value: 59
                - matcher:
                    id: byName
                    options: Pod
                  properties:
                    - id: custom.width
                      value: 98
                - matcher:
                    id: byName
                    options: Microservices
                  properties:
                    - id: custom.width
                      value: 20
                - matcher:
                    id: byName
                    options: Microservices
                  properties:
                    - id: custom.width
                      value: 139
                - matcher:
                    id: byName
                    options: Configuration
                  properties:
                    - id: custom.width
                      value: 158
                - matcher:
                    id: byName
                    options: Passwords
                  properties:
                    - id: custom.width
                      value: 33
                - matcher:
                    id: byName
                    options: Spaces
                  properties:
                    - id: custom.width
                      value: 160
          gridPos:
            h: 10
            w: 14
            x: 0
            "y": 14
          id: 51
          options:
            cellHeight: sm
            footer:
                countRows: false
                fields: ""
                reducer:
                    - sum
                show: true
            showHeader: true
            sortBy:
                - desc: true
                  displayName: Configuration
          pluginVersion: 11.6.0
          targets:
            - datasource:
                type: prometheus
                uid: ${datasource}
              editorMode: code
              expr: count(kube_pod_info{origin_prometheus=~"$origin_prometheus",node=~"^$Node$"}) by (namespace)
              format: table
              hide: false
              instant: true
              interval: ""
              legendFormat: ""
              refId: A
            - datasource:
                type: prometheus
                uid: ${datasource}
              editorMode: code
              expr: count(kube_service_info{origin_prometheus=~"$origin_prometheus"}) by(namespace)
              format: table
              hide: false
              instant: true
              interval: ""
              legendFormat: ""
              refId: C
            - datasource:
                type: prometheus
                uid: ${datasource}
              editorMode: code
              expr: count by (namespace)({__name__=~"kube_deployment_metadata_generation|kube_daemonset_metadata_generation|kube_statefulset_metadata_generation",origin_prometheus=~"$origin_prometheus"})
              format: table
              hide: false
              instant: true
              interval: ""
              legendFormat: __auto
              refId: D
            - datasource:
                type: prometheus
                uid: ${datasource}
              editorMode: code
              expr: count(kube_configmap_info{origin_prometheus=~"$origin_prometheus"}) by(namespace)
              format: table
              hide: false
              instant: true
              interval: ""
              legendFormat: configmap
              refId: B
            - datasource:
                type: prometheus
                uid: ${datasource}
              editorMode: code
              expr: count(kube_secret_info{origin_prometheus=~"$origin_prometheus"}) by(namespace)
              format: table
              hide: false
              instant: true
              interval: ""
              legendFormat: secret
              refId: E
          title: Namespace Resource Statistics
          transformations:
            - id: seriesToColumns
              options:
                byField: namespace
            - id: organize
              options:
                excludeByName:
                    Time: true
                    Time 1: true
                    Time 2: true
                    Time 3: true
                    Time 4: true
                    Time 5: true
                includeByName: {}
                indexByName:
                    Time 1: 2
                    Time 2: 4
                    Time 3: 6
                    'Value #A': 3
                    'Value #C': 5
                    'Value #D': 1
                    namespace: 0
                renameByName:
                    Time 1: ""
                    Time 2: ""
                    'Value #A': Pod
                    'Value #B': Configuration
                    'Value #C': SVC
                    'Value #D': Microservices
                    'Value #E': Passwords
                    namespace: Spaces
          type: table
        - datasource:
            type: prometheus
            uid: ${datasource}
          fieldConfig:
            defaults:
                color:
                    mode: palette-classic
                custom:
                    axisBorderShow: false
                    axisCenteredZero: false
                    axisColorMode: series
                    axisLabel: ""
                    axisPlacement: auto
                    barAlignment: 0
                    barWidthFactor: 0.6
                    drawStyle: line
                    fillOpacity: 30
                    gradientMode: opacity
                    hideFrom:
                        legend: false
                        tooltip: false
                        viz: false
                    insertNulls: false
                    lineInterpolation: linear
                    lineStyle:
                        fill: solid
                    lineWidth: 2
                    pointSize: 4
                    scaleDistribution:
                        type: linear
                    showPoints: never
                    spanNulls: false
                    stacking:
                        group: A
                        mode: none
                    thresholdsStyle:
                        mode: "off"
                links: []
                mappings: []
                thresholds:
                    mode: absolute
                    steps:
                        - color: green
                        - color: red
                          value: 80
                unit: binbps
            overrides: []
          gridPos:
            h: 10
            w: 10
            x: 14
            "y": 14
          id: 32
          options:
            legend:
                calcs:
                    - max
                displayMode: list
                placement: bottom
                showLegend: true
                width: 200
            tooltip:
                hideZeros: false
                mode: multi
                sort: desc
          pluginVersion: 11.6.0
          targets:
            - datasource:
                type: prometheus
                uid: ${datasource}
              disableTextWrap: false
              editorMode: builder
              exemplar: true
              expr: sum(irate(container_network_receive_bytes_total{namespace=~"$NameSpace"}[2m])) * 8
              format: time_series
              fullMetaSearch: false
              includeNullMetadata: true
              interval: ""
              intervalFactor: 1
              legendFormat: Receive
              metric: network
              range: true
              refId: A
              step: 10
              useBackend: false
            - datasource:
                type: prometheus
                uid: ${datasource}
              disableTextWrap: false
              editorMode: builder
              exemplar: true
              expr: sum(irate(container_network_transmit_bytes_total{namespace=~"$NameSpace"}[2m])) * 8
              fullMetaSearch: false
              includeNullMetadata: true
              instant: false
              interval: ""
              intervalFactor: 1
              legendFormat: Send
              metric: network
              refId: B
              step: 10
              useBackend: false
          title: $NameSpace：Network Overview（Associable nodes and namespaces）
          type: timeseries
    preload: false
    refresh: ""
    schemaVersion: 41
    tags:
        - kasha
        - infra
    templating:
        list:
            - current:
                text: ""
                value: ""
              datasource:
                type: prometheus
                uid: ${datasource}
              definition: label_values(kube_node_info,origin_prometheus)
              description: Do not remove
              hide: 2
              includeAll: false
              label: K8S
              name: origin_prometheus
              options: []
              query:
                query: label_values(kube_node_info,origin_prometheus)
                refId: StandardVariableQuery
              refresh: 2
              regex: ""
              sort: 5
              type: query
            - allValue: .*
              current:
                text: All
                value: $__all
              datasource:
                type: prometheus
                uid: ${datasource}
              definition: label_values(kube_node_info,node)
              includeAll: true
              label: Nodes
              name: Node
              options: []
              query:
                qryType: 1
                query: label_values(kube_node_info,node)
                refId: PrometheusVariableQueryEditor-VariableQuery
              refresh: 2
              regex: ""
              sort: 5
              type: query
            - allValue: .*
              current:
                text: All
                value: $__all
              datasource:
                type: prometheus
                uid: ${datasource}
              definition: label_values(kube_namespace_status_phase,namespace)
              includeAll: true
              label: Namespace
              name: NameSpace
              options: []
              query:
                qryType: 1
                query: label_values(kube_namespace_status_phase,namespace)
                refId: PrometheusVariableQueryEditor-VariableQuery
              refresh: 2
              regex: ""
              sort: 5
              type: query
            - allValue: .*
              current:
                text: All
                value: $__all
              datasource:
                type: prometheus
                uid: ${datasource}
              definition: label_values(kube_pod_container_info{namespace=~"$NameSpace"},container)
              includeAll: true
              label: Microservice (Container Name)
              name: Container
              options: []
              query:
                qryType: 1
                query: label_values(kube_pod_container_info{namespace=~"$NameSpace"},container)
                refId: PrometheusVariableQueryEditor-VariableQuery
              refresh: 2
              regex: ""
              sort: 5
              type: query
            - allValue: .*
              current:
                text: All
                value: $__all
              datasource:
                type: prometheus
                uid: ${datasource}
              definition: label_values(kube_pod_container_info{namespace=~"$NameSpace", container=~"$Container"},pod)
              includeAll: true
              label: Pod
              name: Pod
              options: []
              query:
                qryType: 1
                query: label_values(kube_pod_container_info{namespace=~"$NameSpace", container=~"$Container"},pod)
                refId: PrometheusVariableQueryEditor-VariableQuery
              refresh: 2
              regex: ""
              sort: 5
              type: query
            - allowCustomValue: false
              current:
                text: metrics-gke-prod-kasha
                value: beih2n435vc3kb
              name: datasource
              options: []
              query: prometheus
              refresh: 1
              regex: ""
              type: datasource
    time:
        from: now-30m
        to: now
    timepicker:
        refresh_intervals:
            - 30s
            - 1m
            - 5m
            - 15m
            - 30m
            - 1h
    timezone: browser
    title: System Overview - Kubernetes v2
    uid: fekl9lvt8iwaob
